import{t as o,a as B,S as C,b as E,c as F,n as j,s as R,g as T,d as O,e as A,f as L,r as p,h as q,i as W,j as h,F as f,k as e,p as P,l as _,m as N,o as V,q as z,B as D,u as w,v as k,T as u,w as G,x as M,y as H,z as K,A as J}from"./index.53257ccc.js";import{d as Q}from"./ConfirmationDialog.a7a2f2a6.js";import{e as $,S as X,c as Y,a as Z,b as ee,d as te,f as ne}from"./ShipTypeFilterButton.2fdaf4ee.js";import{A as se}from"./ActionBar.a82b5bc2.js";import{C as ae,S as ie,c as oe}from"./ShipDataTable.cc293767.js";import{d as re,a as I,b as le,I as ce,E as pe}from"./ExportDataDialog.966ec173.js";import{d as ue}from"./Save.ca91e564.js";import{B as de}from"./ButtonMenu.f1a65ba1.js";import{E as he}from"./ExpandStack.02d0c316.js";import{R as me}from"./ResponsiveDialog.acaef157.js";import{T as ge}from"./TextField.df18bb81.js";import{N as ye,P as fe}from"./PageContent.fa3fdfd2.js";import{P as Se}from"./PageFooter.cb64c618.js";import"./DialogContentText.4c47a8c7.js";import"./domUtils.d9c29d75.js";import"./MenuItem.7c478d3c.js";import"./Popper.977ded31.js";import"./ClickAwayListener.d4fa9078.js";import"./useFormControl.f5ec564d.js";import"./useTable.126443fd.js";import"./TableRow.062581c6.js";import"./Alert.f495aeb0.js";import"./Download.7d2358a7.js";import"./Select.bdd9fab0.js";function U(a,t){const n=[],r=[],i=[],d=[],c=[];a.forEach(s=>{switch(s.row){case C.FRONT:{n.push(s);break}case C.MIDDLE:{r.push(s);break}case C.BACK:{i.push(s);break}default:switch(s.type){case F.CORVETTE:{d.push(s);break}case F.FIGHTER:{c.push(s);break}}}});const l=j([(s,m)=>R(s.type,s.subType)-R(m.type,m.subType),(s,m)=>T(s).localeCompare(T(m),O())]);return[o("label.acquiredShipsAndBlueprints"),[o("myList.groupNameForSharing",{name:B(C.FRONT)}),...n.sort(l).map(s=>b(s,t))].join(`
`),[o("myList.groupNameForSharing",{name:B(C.MIDDLE)}),...r.sort(l).map(s=>b(s,t))].join(`
`),[o("myList.groupNameForSharing",{name:B(C.BACK)}),...i.sort(l).map(s=>b(s,t))].join(`
`),[o("myList.groupNameForSharing",{name:E(F.CORVETTE)}),...d.sort(l).map(s=>b(s,t))].join(`
`),[o("myList.groupNameForSharing",{name:E(F.FIGHTER)}),...c.sort(l).map(s=>b(s,t))].join(`
`)].join(`

`)}function b(a,t){const n=A(a,t);return n.length===0?`\u3000${T(a)}`:[`\u3000${T(a)}`,n.map(r=>`\u3000\u2517 ${r.category}${r.categoryNumber} ${L(a.id,r)}`).join(`
`)].join(`
`)}const Ce=a=>{const{onCopyAsText:t,buttonProps:n}=a,[r,i]=p.exports.useState(!1),[d,c]=p.exports.useState(null),[l,s]=p.exports.useState(null),m=p.exports.useCallback(g=>{switch(g){case"copyAsText":{t();break}case"import":{s(W()),i(!0);break}case"export":{c(q());break}}},[]),S=p.exports.useCallback((g,x)=>{if(l===null){x();return}g(l)},[l]);return h(f,{children:[e(de,{icon:e(re,{}),text:o("button.share"),value:void 0,buttonProps:n,onClick:m,options:[{key:"copyAsText",icon:e(I,{}),text:o("label.copyAsText"),value:"copyAsText"},{key:"export",icon:e(ue,{}),text:o("label.dataExport"),value:"export"},{key:"import",icon:e(le,{}),text:o("label.dataImport"),value:"import"}]}),r&&e(ce,{confirmDialogTitle:o("myList.importConfirmTitle"),confirmWarning:o("myList.importConfirmWarning"),createPreview:be,parseInput:P,canRestore:!!l,onImport:xe,onClose:()=>i(!1),onSelectFile:Fe,onRestoreFromBackup:S}),d&&e(pe,{fileName:"settings",jsonContent:d,onClose:()=>c(null),onStoreBackup:_})]})};function be(a){const t=$(N,a.ships);return U(t,a)}function xe(a){V(a),setTimeout(()=>{window.location.reload()},0)}function Fe(a,t){(async()=>{const n=await z();if(n===null){t();return}a(n)})()}const ve=a=>{const{shipFilter:t,columnConfig:n,onEdit:r,onFilter:i,onCopyAsText:d,onColumnConfigChange:c}=a;return e(se,{left:l=>h(f,{children:[e(ae,{columnConfig:n,onChange:c,disableResearchAgreementOptions:!0,buttonProps:l},"columnConfig"),e(X,{filter:t,onChange:i,researchManufacturer:!1,researchStrategyTypes:!1,researchTacticTypes:!1,buttonProps:l},"filter"),e(D,{variant:"outlined",startIcon:e(Q,{}),onClick:r,...l,children:o("myList.editMyList")},"edit")]}),right:l=>e(f,{children:e(Ce,{onCopyAsText:d,buttonProps:l})})})},Te=a=>{const{ship:t}=a,{userSettings:n}=w(),r=p.exports.useMemo(()=>A(t,n),[t,n]);return r.length===0?null:e(k,{component:"div",mt:.5,children:r.map(i=>h(u,{variant:"body2",color:"text.secondary",children:[e(u,{variant:"body2",component:"span",color:"text.secondary",sx:{opacity:.5},children:"\u2517 "}),`${i.category}${i.categoryNumber} ${L(t.id,i)}`]},i.id))})},we=a=>{const{ship:t}=a,{userSettings:n}=w(),r=p.exports.useMemo(()=>G(t,n),[t,n]);return r.length===0?null:e(k,{component:"div",mt:.5,children:r.map(i=>h(u,{variant:"body2",color:"text.secondary",children:[e(u,{variant:"body2",component:"span",color:"text.secondary",sx:{opacity:.5},children:"\u2517 "}),`${i.category}${i.categoryNumber} ${L(t.id,i)}`]},i.id))})},v=p.exports.memo(ie),ke=a=>{const{shipListState:t,columnConfig:n}=a;return h(M,{spacing:1,children:[e(he,{expandables:[{id:"possessed-ships",initiallyOpened:!0,summary:e(u,{variant:"body1",children:o("label.acquiredShipsAndBlueprints")}),details:e(v,{shipDefinitions:t.possessed,columnConfig:n,decorateName:(r,i)=>h(f,{children:[r,e(Te,{ship:i})]})})},{id:"wished-ships",initiallyOpened:!1,summary:e(u,{variant:"body1",children:o("label.wantedBlueprints")}),details:e(v,{shipDefinitions:t.wished,columnConfig:n,decorateName:(r,i)=>h(f,{children:[r,e(we,{ship:i})]})})},{id:"unwished-by-user-ships",initiallyOpened:!1,summary:e(u,{variant:"body1",children:o("label.unwantedBlueprints")}),details:e(v,{shipDefinitions:t.unwishedByUser,columnConfig:n})},{id:"unwished-by-data-ships",initiallyOpened:!1,summary:e(u,{variant:"body1",children:o("myList.unwantedDuplicates")}),details:h(f,{children:[e(v,{shipDefinitions:t.unwishedByData,columnConfig:n}),e(k,{component:"div",pt:1,children:e(u,{variant:"caption",align:"right",paragraph:!0,children:o("myList.unwantedDuplicatesFootnote")})})]})}]}),e(u,{variant:"caption",align:"right",paragraph:!0,children:o("myList.pageFootnote")})]})},Be=a=>{const{ships:t,onClose:n}=a,[r,i]=p.exports.useState(!1),{userSettings:d}=w(),[c,l]=p.exports.useState(()=>U(t.possessed,d)),s=()=>{c&&K(c).then(()=>{i(!0)})},m=g=>{l(g.target.value)},S=()=>{n(),i(!1)};return e(me,{title:o("button.share"),content:h(M,{spacing:1,children:[e(ge,{variant:"filled",id:"outlined-multiline-static",multiline:!0,onChange:m,rows:10,defaultValue:c,fullWidth:!0}),!!navigator.clipboard&&e(D,{variant:"outlined",startIcon:r?e(H,{}):e(I,{}),onClick:s,fullWidth:!0,children:o("button.copyToClipboard")})]}),actions:e(D,{variant:"outlined",onClick:S,children:o("button.close")}),onClose:S})},Ye=()=>{const a=J(),{userSettings:t}=w(),[n,r]=p.exports.useState(Y),[i,d]=p.exports.useState(null),[c,l]=p.exports.useState(()=>oe({name:!0,row:!0,type:!0,cost:!1,operationLimit:!1})),s=p.exports.useMemo(()=>{const y=Z(N,n);return{possessed:$(y,t.ships),wished:ee(y,t),unwishedByUser:te(y,t.ships),unwishedByData:ne(y,t)}},[t,n]),m=()=>{a("/myList/edit")},S=()=>{d(s)},g=()=>{d(null)},x=Object.values(c).filter(y=>typeof y=="boolean"&&y).length>3;return h(f,{children:[e(ye,{currentRoute:"/myList"}),e(ve,{shipFilter:n,columnConfig:c,onEdit:m,onFilter:r,onCopyAsText:S,onColumnConfigChange:l}),e(fe,{disableContainer:x,children:h(k,{component:"div",p:1,children:[h(M,{pt:1,pb:2,spacing:2,children:[e(u,{variant:"body2",children:o("myList.pageDescription1")}),e(u,{variant:"body2",children:o("myList.pageDescription2")}),e(u,{variant:"body2",children:o("myList.pageDescription3")})]}),e(ke,{shipListState:s,columnConfig:c})]})}),i&&e(Be,{ships:i,onClose:g}),e(Se,{disableContainer:x})]})};export{Ye as MyListPage,Ye as default};
